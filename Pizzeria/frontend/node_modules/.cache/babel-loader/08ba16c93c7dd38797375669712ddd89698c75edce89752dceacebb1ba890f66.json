{"ast":null,"code":"import _objectSpread from\"/Users/iara/Projects/PassionProject/Pizzeria/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{fetchPizzas,placeOrder}from'../api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function OrderNow(){const[pizzas,setPizzas]=useState([]);const[cart,setCart]=useState({});const[form,setForm]=useState({customer_name:'',address:'',phone:''});const[message,setMessage]=useState(null);useEffect(()=>{fetchPizzas().then(setPizzas);},[]);function addToCart(pizzaId){setCart(prev=>_objectSpread(_objectSpread({},prev),{},{[pizzaId]:(prev[pizzaId]||0)+1}));}function removeFromCart(pizzaId){setCart(prev=>{const copy=_objectSpread({},prev);if(!copy[pizzaId])return copy;copy[pizzaId]--;if(copy[pizzaId]<=0)delete copy[pizzaId];return copy;});}async function submit(){const items=Object.entries(cart).map(_ref=>{let[pizza_id,quantity]=_ref;return{pizza_id:Number(pizza_id),quantity};});const payload=_objectSpread(_objectSpread({},form),{},{items});const result=await placeOrder(payload);if(result&&result.id){setMessage(\"Pedido recebido! ID \".concat(result.id));setCart({});setForm({customer_name:'',address:'',phone:''});}else{setMessage('Erro ao enviar pedido.');}}return/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Pe\\xE7a Agora\"}),/*#__PURE__*/_jsx(\"div\",{className:\"menu-list\",children:pizzas.map(p=>/*#__PURE__*/_jsxs(\"div\",{className:\"order-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-details\",children:[/*#__PURE__*/_jsx(\"strong\",{children:p.name}),\" - \",/*#__PURE__*/_jsxs(\"span\",{className:\"price\",children:[\"R$ \",parseFloat(p.price).toFixed(2)]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{style:{color:'#666'},children:p.description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"quantity-controls\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"qty-btn\",onClick:()=>removeFromCart(p.id),children:\"-\"}),/*#__PURE__*/_jsx(\"span\",{className:\"quantity\",children:cart[p.id]||0}),/*#__PURE__*/_jsx(\"button\",{className:\"qty-btn\",onClick:()=>addToCart(p.id),children:\"+\"})]})]},p.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-summary\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Seu Pedido\"}),/*#__PURE__*/_jsx(\"div\",{className:\"cart-items\",children:Object.entries(cart).length===0?/*#__PURE__*/_jsx(\"p\",{style:{color:'#666',fontStyle:'italic'},children:\"Carrinho vazio\"}):/*#__PURE__*/_jsx(\"ul\",{style:{listStyle:'none',padding:0},children:Object.entries(cart).map(_ref2=>{let[id,qty]=_ref2;const pizza=pizzas.find(p=>p.id===Number(id));return/*#__PURE__*/_jsxs(\"li\",{style:{padding:'8px 0',borderBottom:'1px solid #eee'},children:[pizza===null||pizza===void 0?void 0:pizza.name,\" x \",qty,\" = \",/*#__PURE__*/_jsxs(\"span\",{className:\"price\",children:[\"R$ \",(parseFloat((pizza===null||pizza===void 0?void 0:pizza.price)||0)*qty).toFixed(2)]})]},id);})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"customer-form\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Dados para Entrega\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Nome\",value:form.customer_name,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{customer_name:e.target.value}))}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Endere\\xE7o\",value:form.address,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{address:e.target.value}))}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Telefone\",value:form.phone,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{phone:e.target.value}))}),/*#__PURE__*/_jsx(\"button\",{onClick:submit,disabled:Object.keys(cart).length===0,className:Object.keys(cart).length===0?'disabled':'',children:\"Enviar Pedido\"}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"notice\",children:message})]})]});}","map":{"version":3,"names":["React","useState","useEffect","fetchPizzas","placeOrder","jsx","_jsx","jsxs","_jsxs","OrderNow","pizzas","setPizzas","cart","setCart","form","setForm","customer_name","address","phone","message","setMessage","then","addToCart","pizzaId","prev","_objectSpread","removeFromCart","copy","submit","items","Object","entries","map","_ref","pizza_id","quantity","Number","payload","result","id","concat","className","children","p","name","parseFloat","price","toFixed","style","color","description","onClick","length","fontStyle","listStyle","padding","_ref2","qty","pizza","find","borderBottom","placeholder","value","onChange","e","target","disabled","keys"],"sources":["/Users/iara/Projects/PassionProject/Pizzeria/frontend/src/components/OrderNow.jsx"],"sourcesContent":["import React, {useState, useEffect} from 'react';\nimport { fetchPizzas, placeOrder } from '../api';\n\nexport default function OrderNow(){\n  const [pizzas, setPizzas] = useState([]);\n  const [cart, setCart] = useState({});\n  const [form, setForm] = useState({customer_name:'', address:'', phone:''});\n  const [message, setMessage] = useState(null);\n\n  useEffect(()=>{ fetchPizzas().then(setPizzas); }, []);\n\n  function addToCart(pizzaId){\n    setCart(prev => ({...prev, [pizzaId]: (prev[pizzaId] || 0) + 1}));\n  }\n\n  function removeFromCart(pizzaId){\n    setCart(prev => {\n      const copy = {...prev};\n      if(!copy[pizzaId]) return copy;\n      copy[pizzaId]--;\n      if(copy[pizzaId] <= 0) delete copy[pizzaId];\n      return copy;\n    });\n  }\n\n  async function submit(){\n    const items = Object.entries(cart).map(([pizza_id, quantity]) => ({pizza_id: Number(pizza_id), quantity}));\n    const payload = {...form, items};\n    const result = await placeOrder(payload);\n    if(result && result.id){\n      setMessage(`Pedido recebido! ID ${result.id}`);\n      setCart({});\n      setForm({customer_name:'', address:'', phone:''});\n    } else {\n      setMessage('Erro ao enviar pedido.');\n    }\n  }\n\n  return (\n    <div className=\"card\">\n      <h2>Peça Agora</h2>\n      <div className=\"menu-list\">\n        {pizzas.map(p => (\n          <div key={p.id} className=\"order-item\">\n            <div className=\"item-details\">\n              <strong>{p.name}</strong> - <span className=\"price\">R$ {parseFloat(p.price).toFixed(2)}</span><br/>\n              <small style={{color: '#666'}}>{p.description}</small>\n            </div>\n            <div className=\"quantity-controls\">\n              <button className=\"qty-btn\" onClick={()=>removeFromCart(p.id)}>-</button>\n              <span className=\"quantity\">{cart[p.id] || 0}</span>\n              <button className=\"qty-btn\" onClick={()=>addToCart(p.id)}>+</button>\n            </div>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"order-summary\">\n        <h3>Seu Pedido</h3>\n        <div className=\"cart-items\">\n          {Object.entries(cart).length === 0 ? (\n            <p style={{color: '#666', fontStyle: 'italic'}}>Carrinho vazio</p>\n          ) : (\n            <ul style={{listStyle: 'none', padding: 0}}>\n              {Object.entries(cart).map(([id,qty])=>{\n                const pizza = pizzas.find(p=>p.id===Number(id));\n                return (\n                  <li key={id} style={{padding: '8px 0', borderBottom: '1px solid #eee'}}>\n                    {pizza?.name} x {qty} = <span className=\"price\">R$ {(parseFloat(pizza?.price || 0) * qty).toFixed(2)}</span>\n                  </li>\n                );\n              })}\n            </ul>\n          )}\n        </div>\n      </div>\n\n      <div className=\"customer-form\">\n        <h3>Dados para Entrega</h3>\n        <input \n          placeholder=\"Nome\" \n          value={form.customer_name} \n          onChange={e=>setForm({...form, customer_name:e.target.value})}\n        />\n        <input \n          placeholder=\"Endereço\" \n          value={form.address} \n          onChange={e=>setForm({...form, address:e.target.value})}\n        />\n        <input \n          placeholder=\"Telefone\" \n          value={form.phone} \n          onChange={e=>setForm({...form, phone:e.target.value})}\n        />\n        <button \n          onClick={submit} \n          disabled={Object.keys(cart).length===0}\n          className={Object.keys(cart).length===0 ? 'disabled' : ''}\n        >\n          Enviar Pedido\n        </button>\n        {message && <div className=\"notice\">{message}</div>}\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}